---
title: ACEE数学建模作业+小测提示(2024版)
published: 2024-12-15
description: "工高数学建模的一些作业提示，希望帮到后来人"
image: "./dawn.jpg"
tags: ["ACEE", "浙江大学工高班", "数学建模", "record"]
category: Guides
draft: false
---
# ACEE数学建模作业+小测提示(2024版)

考虑到很多同学这门课对于一些作业可能需要一些提示，这里我为大家提供一些视角和参考，注意内容仅供参考，请勿抄袭～

## 周期一 雪灾浙大作业

(之前写的有点谜语人，考虑改清楚点)

### T1:排序问题

:::note[标签]

keywords:`分类讨论`，`三角不等式`

:::

- 问1:略
- 问2:
  - 法一：分类讨论正偏态和负偏态情况，强行展开绝对值
  - 法二：三角不等式硬上，利用绝对值的差和差的绝对值，以及绝对值的和和和的绝对值之间的关系解题。可以找一个中转点，$A\leqslant 2B\Leftrightarrow A-B\leqslant A$
- 问3:
  - 中位数$\mu$是整数无限制下的最优解，$\sigma'$是排列意义下对$\mu$的逼近，$\sigma^*$是排列限制下最优解
  - 在这个意义上我们可以利用三角不等式，通过建立中间点来实现拆项
  - 对于$\beta$我们没有更好的性质，考虑用问2来搭桥

### T2:赛程计分问题

:::note[标签]

keywords:`递推`，`向量表示`

:::

第二题可能需要提示的是第四问，很容易想到向前递推，这里需要考虑清楚的是第一步的边贡献次数是多少。

:::warning[tip]

在给出答案前，想一想你真的能化简吗?

:::

具体过程如下：

<iframe
  src="/pdfjs-4.6.82-dist/web/viewer.html?file=/file/HW1(unlock).pdf"
  width="100%"
  height="800px"
></iframe>

## 周期一 慕课作业

### 单循环赛break下限证明

pattern互不相同，只有两种能不出break

### 砍竹子问题

:::tip

竹子最高高度存在上界，其对偶表述是总高度增加量存在下界

:::

反证法，每个时刻总量增加总是H-当前砍伐高，你总能拉上去

## 小测一 线性规划转化问题

:::tip

本题的核心是引导大家利用01变量去刻画常规的多种关系，具体而言，要习惯于用对指标枚举去表示某些特定的数值/数值集合，也就是从是多少到有没有的转化。

可以借鉴的是[这本书](https://docs.mosek.com/modeling-cookbook/mio.html)

:::note

| Boolean                   | Linear                              |
| ------------------------- | ----------------------------------- |
| $z= x\ \mathrm{OR}\ y$  | $x\leq z,\ y\leq z,\ z\leq x+y$   |
| $z= x\ \mathrm{AND}\ y$ | $x\geq z,\ y\geq z,\ z+1\geq x+y$ |
| $z= \mathrm{NOT}\ x$    | $z=1-x$                           |
| $x\implies y$           | $x\leq y$                         |

:::

> 有$n$个小区需要服务，$m$处可以开设服务，开设服务费费用为$f_i$，提供服务的费用为$c_{i,j}$，每个最小化费用
> 不相容约束，某些小区不能同时由某一个服务点提供服务，记为:$\{a_k,b_k\}(k=1,2,\cdots,s)$
> 双指派约束，每个小区有两个服务点提供服务，且某些小区对有一个公共服务点:$\{c_w,d_w\}(w=1,2,\cdots,t)$

$x_i=[i$有服务$]$

$y_{ij}=[i$有点且在$j$小区服务$]$

$z_{i,t}=[i$为$c_t,d_t$的公共点$]$

则显然可以直接写出

$$
\min \sum _{i=1}^m f_ix_i+\sum _{i=1}^m\sum _{j=1}^n c_{ij}y_{ij}
$$

$$
\begin{align}s.t. x_i\in \{0,1\},y_{ij}&\in \{0,1\},z_{i,w}\in \{0,1\}\\y_{ij}&\leqslant x_i\\\sum _{i=1}^my_{ij} &\geqslant 1(=2)\\y_{ia_k}+y_{ib_k}&\leqslant 1\\z_{iw}&\leqslant y_{i,c_w}\\z_{iw}&\leqslant y_{i,d_w}\\z_{iw}+1&\geqslant y_{ic_w}+y_{id_w}\\\sum _{i=1}^m z_{iw}&\geqslant 1&\end{align}
$$

老师给的答案如下，实际上并不优秀，因为约束数反而变多了

$$
\begin{align}s.t. x_i\in \{0,1\}&,y_{ij}\in \{0,1\}\\y_{ij}&\leqslant x_i\\\sum _{i=1}^my_{ij} &\geqslant 1(=2)\\y_{ia_k}+y_{ib_k}&\leqslant 1\\x_{i_1c_w}+x_{i_2c_w}&\geqslant x_{i_1d_w}+x_{i_2d_w}-1\\\sum _{i=1}^m z_{iw}&\geqslant 1&\end{align}
$$

## 周期二 慕课作业

### T1 吉祥三宝

> 在杭州迎接2022年第19届亚洲运动会时，n名同学正在老师的带领下与亚运会吉祥物“江南忆”做游戏。游戏开始前，同学可以商定在游戏中采取的策略，但游戏进行过程中，同学之间不能互相交流。游戏开始时，老师在每位同学的背后贴上印有三个吉祥物“琮琮”、“宸宸”和“莲莲”之一的图案，不同同学背后的图案可以不同。每个同学不能看到自己背后的图案，但能看到除他自己外所有其他同学的图案。
>
> （1）现老师要求所有同学分站为3列。每列所有同学背后的图案均完全相同时，视为 “成功”。试给出一种策略，使成功的可能性尽可能大；
>
> （2）现老师要求每位同学同时在纸上画出自己背后的图案。一位同学所画的图案与自己背后的图案相同时视为该同学“成功”。试给出一种策略，使该策略能确保成功的同学数量尽可能多。

为了方便说明，我们将背后贴上印有三个吉祥物“琮琮”、“宸宸”和“莲莲"的图案的同学分别符号化为A，B，C

(1)

【法一】

下面我们将说明存在策略，成功的可能性为$1$

具体而言

我们设每个同学看到的A,B,C个数为$a,b,c$

则显然$a+b+c=n-1$，且具体而言，设所有同学中A,B,C个数为$a_0,b_0,c_0$

则$a=a_0-[\mathtt{self.c=A}],b=b_0-[\mathtt{self.c=B}],c=c_0-[\mathtt{self.c=C}]$

我们构造排队方法

假设$(a-b)\mod 3\equiv 0$，其归到$1$队

假设$(a-b)\mod 3\equiv 1$，其归到$2$队

假设$(a-b)\mod 3\equiv 2$，其归到$3$队

在这种策略下，

- 本身是$\mathtt A$ :  $(a-b)\equiv (a_0-b_0-1)\mod 3$
- 本身是$\mathtt B$ :  $(a-b)\equiv (a_0-b_0+1)\mod 3$
- 本身是$\mathtt C$ :  $(a-b)\equiv (a_0-b_0)\mod 3$

容易发现不同属性（即背后吉祥物不同）会有不同的计算结果，因此会被分到三个队列中

【法二】

首先，我们为每个人分配一个序号$i$，我们设$h_i$表示第$i$个人的颜色译码，设为

$$
h_i=\begin{cases}0&\mathtt{self_i.c=A}\\1&\mathtt{self_i.c=B}\\2&\mathtt{self_i.c=C}\end{cases}
$$

则我们将$i$分到$(\sum _{j\neq i}h_j\mod 3)+1$队列，则为一个合法的安排

证明和上面基本相同，这里不再赘述

:::tip[hint]

$-1\equiv 2\mod 3$

:::

(2)

延续(1)【法二】的定义，我们用0,1,2表示A,

设$n=3k+r(0 \leqslant m <3)$,即$k=\lfloor\frac{n}{3}\rfloor$

考虑如下策略

- $1\leqslant i\leqslant k$，猜测图案为$-\sum \limits _{j\neq i}  h_j\pmod 3$
- $k+1\leqslant i\leqslant 2k+[r\geqslant 1]$，猜测图案为$1-\sum \limits _{j\neq i}  h_j\pmod 3$
- $2k+1+[r\geqslant 1]\leqslant i\leqslant 3k+[r\geqslant 1]+[r\geqslant 2]$，猜测图案为$2-\sum \limits _{j\neq i}  h_j\pmod 3$

容易证明

前$k$名同学，中间$k+[r\geqslant 1]$名同学，后面$k+[r\geqslant 2]$名同学 这三组同学，至少有完整的一组选择正确（证明基于分类讨论反证即可）

因此能保证至少$k=\lfloor\frac{n}{3}\rfloor$个成功

### T2 假币识别问题

(1)

> 某种硬币单枚质量为$W$克。现有$N$堆该种硬币，依次标记为$1，2,...,N$。其中可能有若干堆，每堆均是伪币。所有伪币质量均相同，且不为$W$。伪币所在堆的指标集记为$I$。为求出$I$，现用一可精确测得质量的电子秤称量两次。第一次从每堆硬币中各取1枚，称得总质量为$M_{1}$克，第二次从第i堆硬币中取$p^i$枚，i=1,2,...,N,称得总质量为$M_2$克，这里p为正整数(假设每堆硬币数量足够多)。
> (1)试给出$M_1,M_2$和W的某个函数，其值仅与I和p有关，而与伪币的质量无关；
> (2)为能用上述方法通过两次称量求出指标集I，p应满足什么条件？试给出某个满足条件的p
> 值；并说明若取$\mathfrak{p}=2$,可能无法用上述方法通过两次称量求出I。

$$
M_1=(N-|I|)W+|I|W'\\M_2=W\sum _{i\notin I}p^i+W'\sum _{i\in I}p^i\\
$$

有

$$
(M_1-NW)+\frac{|I|}{\sum _{i\in I}p^i}\left(\frac{p(1-p^N)}{1-p}W-M_2\right)
$$

 因此我们

可以构造函数

$$
F(M_1,M_2,W,N,p)=\frac{(M_1-NW)}{\left(M_2-\frac{p(1-p^N)}{1-p}W\right)}=\frac{|I|}{\sum _{i\in I }p^i}
$$

更好理解的形式是

$$
F(M_1,M_2,W,N,p)=\frac{M_2-\left(\frac{p(1-p^N)}{1-p}W\right)}{(M_1-NW)}=\frac{\sum _{i\in I }p^i}{|I|}
$$

我们已经给出了符合要求的函数

(2)

首先我们给出能够通过两次称量求出$I$的量化条件

对于

$$
F(M_1,M_2,W,N,p)=\frac{\sum _{i\in I }p^i}{|I|}=G_p(I)
$$

> 若对给定的$p$，$\forall I_1\neq I_2,G_p(I_1)\neq G_p(I_2)$
>
> 则我们称可以还原$I$

下面取$p=N+1$（实际上$p$可以任意取$>N$的正整数），证明还原性存在

若存在$I_1\neq I_2,G_p(I_1)= G_p(I_2)$

则

$$
\frac{\sum \limits_{i\in I_1}p^i}{|I_1|}=\frac{\sum \limits_{i\in I_2}p^i}{|I_2|}
$$

即

$$
|I_2|\sum \limits_{i\in I_1}p^i =|I_1|\sum _{i\in I_2}p^i
$$

容易发现由于$p=N+1>\max\{|I_2|,|I_1|\}$,因此等式两侧是一个$p=N+1$进制数的不同位权表达，这与位权展开的唯一性违背，因此矛盾。

故$\forall I_1\neq I_2,G_p(I_1)\neq G_p(I_2)$

$p=N+1$为一个可行的取法

---

对于$p=2$

我们可以构造一些$N$,和对应的$I_1,I_2$使得可还原性被破坏

反例如下

$$
p=2\\
N=7\\
I_1=\{2,2^3,2^7\}\Rightarrow G_p(I_1)=46\\
I_2=\{2,2^2,2^5,2^6,2^7\}\Rightarrow G_p(I_2)=46
$$

即在$N=7$时存在两个指标集合我们函数获取的值一样，无法区分。

因此$2$不一定能称出来

## 周期三 慕课作业

### T1 变形格雷码

> 一电灯由n个开关控制。每个开关有“开”、“关”两种状态，但开关当前状态未知。每按一次开关可改变开关的状态，当且仅当所有开关均处在“开”状态时电灯才能开启。
>
> （1）若当前电灯未开启，至多按开关多少次总可开启电灯；
>
> （2）给出n=4时的一种实现方式，并将其推广到n为任意值的情形。

(1)

这里给出一个简单的放缩

设$0,1$分别表示关和开，则$1^n$表示全部开启状态即目标状态

一个不执行冗余操作的方案中，每次翻转状态均可以产生一个没有出现的状态，则至少需要$2^n-1$次能够开启点灯

(2)

一个合法方案的本质是一个格雷码，即生成$n$长度所有的$2^n$个01串的排列，使得两两相邻串间相差一位

其中要求最后一个串为1111…

这里我们可以反过来生成从$0^n=0000...0000$出发的01串序列，使得相邻串相差一位

具体而言

对于$n=3$，我们先生成：

`000,001,011,010,110,111,101,100`

然后将其01翻转并序列倒转得到

`011,010,000,001,101,100,110,111`

这样我们就从一个电灯未开启的状态通过$2^3-1=7$步到达了$111$即电灯开启的状态

对于$n=4$是类似的

我们先生成

` 0000 → 1000 → 1100 →0100 → 0110 → 1110 → 1010 → 0010 → 0011 → 1011 → 1111 → 0111 →0101 → 1101 → 1001 → 0001`

最终方案为

`1110 → 0110 → 0010 → 1010 → 1000 → 0000 → 0100 → 1100 → 1101 → 0101 → 0001 → 1001 → 1011 → 0011 → 0111 → 1111`

假设$S_k$为长度为$k$的字符串的一种方案，则$S_k=(\mathrm{rev}(S^R_{k-1})||0)+(S^R_{k-1}||1)$

即可以通过将$S_{k-1}$的每个字符串倒置，然后复制一遍在后面，对前$2^{k-1}$个串做序列反转，并填0，后半字符串填1即可得到$S_k$

换句话说，本题的答案序列是倒置且01翻转的标准格雷码

存在通用的数学表示 ，长度为$k$的串的第$i$个串为$S_k(i)=2^{k}-\left((2^{k}-1-i)\oplus \lfloor\frac{2^{k}-1-i}{2}\rfloor\right)$

这个结果看似复杂，也的确比较复杂（

### T2

> 现有六堆硬币，每堆32枚。硬币有真伪两种，真币每枚重100克，伪币每枚重99克。同一堆硬币要么全是真币，要么全是伪币。现需用可显示重量的电子秤称重**一次**判断出每堆硬币的真假，试给出称量方案，并说明其正确性。若每堆仅有24枚，是否仍存在可行的称量方案？

方案如下，对于第$i$堆，我们取$2^{i-1}$枚$(1\leqslant i\leqslant 6)$

则我们取的集合为$S=\{1,2,4,8,16,32\}$

任意两个子集的和不同，因此可以根据取出的硬币的质量和$63\times 100$作差即可获取伪币所在的堆编号

而假设只有24枚，我们可以取$S=\{11, 17, 20, 22, 23, 24\} $,，容易发现中任意含 $i + 1$ 个元素的子集元素之和大于含 $i$ 个元素的子集之和，仍可以通过与标准值求差确定子集，因此存在称量方案。

## 周期三 学在浙大作业 2 随机模型

### T1 点罚球问题

> 足球比赛在规定时间内打平，且加时赛中双方均无进球时，需要通过点球决胜来决定胜负。点球决胜分为若干轮，每轮中两支球队各罚点球一次。如果若干轮结束后双方进球数相同，则需要继续加赛，直至分出胜负。点球进球的概率很高，因此每轮罚球的先后顺序可能会对结果产生较大影响。
>
> 目前的比赛规则是通过抽签决定哪支球队先罚点球，并且在整个点球决胜过程中，该队始终先罚。新规则提议第一轮先罚球队由抽签决定，之后每轮的罚球顺序与上一轮相反。假设进球概率仅与罚球的先后顺序有关，与球队和轮次无关。设每轮先罚球队进球的概率为 \( p \) ，后罚球队进球的概率为 $q$ ，且 $ p > q $。为了简化问题，假设 $ K = 2 $ 轮。
>
> 问题要求：
>
> 1. 分别计算在两轮结束后，采用现有规则和新规则两种情况下，第一轮先罚球队获胜、第一轮后罚球队获胜以及双方进球数相同的概率。特别地，当 $ p = \frac{3}{4} $ 和 $ q = \frac{2}{3} $ 时，给出具体结果。
> 2. 假设在前两轮结束后，双方进球数相同。分别计算在加赛阶段，采用现有规则和新规则两种情况下，加赛第一轮先罚球队获胜与加赛第一轮后罚球队获胜的概率。

之前学在浙大上做过了，快速重复下

1. 在原规则下，第一轮先罚球球队获胜的概率为

$$
p^2(1-q)^2 + 2p^2q(1-q) + 2p(1-p)(1-q)^2 + p(1-q)(2-p-2q+3pq) = \frac{17}{48},
$$

第一轮后罚球球队获胜的概率为

$$
(1-p)^2 q^2 + 2 p(1-p) q^2 + 2(1-p)^2 q(1-q) + (1-p) q(2-2 p-q+3 p q) = \frac{2}{9},
$$

双方进球数相同的概率为

$$
(1-p)^2(1-q)^2 + 4pq(1-p)(1-q) + p^2q^2 + 6p^2q^2 - 6p^2q - 6pq^2 + 8pq + p^2 + q^2 - 2p - 2q + 1 = \frac{61}{144}.
$$

在新规则下，第一轮先罚球球队获胜的概率为

$$
\begin{align*}
& p(1-q)q(1-p) + pq((1-q)p + (1-p)q) + (1-p)(1-q)((1-p)q + p(1-q)) + (1-p)(1-q)(p+q-pq) + pq(p+q-2pq) = \frac{41}{144}, \\
\end{align*}
$$

第一轮后罚球球队获胜的概率为

$$
(1-p)(1-q) q p + q p((1-p) q + p(1-q)) + (1-p)(1-q)(q(1-p) + p(1-q)) + (1-p)(1-q)(p+q-pq) + pq(p+q-2pq) = \frac{41}{144},
$$

双方进球数相同的概率为

$$
\begin{align*}
& (1-p)^2(1-q)^2 + pq(1-p)(1-q) + pq(1-p)(1-q) + p^2(1-q)^2 + q^2(1-p)^2 + p^2q^2 + (p^2+(1-p)^2)(q^2+(1-q)^2) + 2pq(1-p)(1-q) = \frac{62}{144}.
\end{align*}
$$

其中 \( p(1-q), pq, (1-p)(1-q) \) 分别为前两轮中A进球B未进球，A,B均进球，与A,B均未进球的概率。

2. 这里我们默认带入数值计算
   原规则下，第一轮先罚球队加赛获胜概率满足

$$
p^A = \frac{p(1-q)}{p+q-2pq} = \frac{3}{5},
$$

第一轮后罚球队加赛获胜概率

$$
p^B = 1 - p^A = \frac{2}{5}.
$$

新规则下，第一轮先罚球队加赛获胜概率 \( p^A \) 与第一轮后罚球队加赛获胜概率 \( p^B \) 满足

$$
p^A = p(1-q) + (pq + (1-p)(1-q))p^B = p(1-q) + (pq + (1-p)(1-q))(1-p^A).
$$

即

$$
p^A = \frac{1-q+p^A}{2-p-q+2pq} = \frac{10}{19},
$$

第一轮后罚球队加赛获胜概率为 $\frac{9}{19}$。

### T2 彩票投注问题

> 一种体育彩票以A、B两队之间的$r$场比赛结果为竞猜对象，每场比赛有胜、负两种结果，投注时需竞猜所有场次的获胜队，每位彩民投注额均为1。比赛全部结束后，猜中场次最多的彩民平分全部投注额。若所有彩民猜中的场次数均相等，则投注额由所有彩民平分。
>
> (1) 设$r=1$，只有甲、乙两人投注。已知 A获胜的概率为$a \geq \frac{1}{2}$，乙投注“ A获胜”的概率为$p \in [0,1]$。分别求甲投注“A获胜”和“B获胜”时，他能获得的期望收益；
>
> (2) 设$r=1$，共有包括甲在内的$N+1$人投注。已知 A获胜的概率为$a \geq \frac{1}{2}$，除甲外的其余$N$人投注“A获胜”的概率均为$p \in [0,1]$。试问$a$和$p$满足何种条件时，甲投注“A获胜”可使其期望收益较大；
>
> (3) 设$r=2$，共有包括甲在内的$N+1$人投注，$N$为一充分大的数。已知每场比赛A获胜的概率略大于$\frac{1}{2}$，除甲外的其余$N$人均投注“B获胜两场”。试问此时甲应如何投注可使其期望收益较大。

1. 乙投注 A 且 A 胜或 B 胜的概率分别为 $pa$ 和 $p(1-a)$，乙投注 B 且 A 胜或 B 胜的概率分别为 $(1-p)a$ 和 $(1-p)(1-a)$。甲、乙均投注同一队获胜时双方收益均为 $1$，甲、乙投注不同队时，投注准确的一方收益为 $2$，错误的一方收益为 $0$。因此甲投注 A 和 B 时的期望收益分别为

   $$
   pa + p(1-a)2(1-p)a = p + 2(1-p)a,
   $$

   和

   $$
   2p(1-a) + (1-p)a + (1-p)(1-a) = 1 + p - 2pa.
   $$
2. 除甲外的其余 $N$ 人中，有 $k$ 人投注 A 的概率为 $\binom{N}{k} p^k(1-p)^{N-k}, 0 \leq k \leq N$。若甲投注 A，B 获胜时仅当 $k=N$，甲才有收益。故甲的期望收益为

   $$
   \begin{align*}
   & a\sum_{k=0}^N \binom{N}{k} p^k(1-p)^{N-k} \cdot \frac{N+1}{k+1} + (1-a) p^N \\
   = & a\sum_{k=0}^N \frac{(N+1)!}{(k+1)!(N-k)!} p^k(1-p)^{N-k} + (1-a) p^N \\
   = & a\sum_{k=1}^{N+1} \frac{(N+1)!}{k!(N-k)!} p^{k-1}(1-p)^{N-k+1} + (1-a) p^N \\
   = & a\frac{1}{p}\left(\sum_{k=0}^{N+1} \binom{N+1}{k} p^k(1-p)^{N-k+1} - (1-p)^{N+1}\right) + (1-a) p^N \\
   = & a\cdot\frac{1}{p}(1-(1-p)^{N+1}) + (1-a) p^N
   \end{align*}
   $$

   若甲投注 B，A 获胜时仅当 $k=0$ 甲才有收益。故甲的期望收益为

   $$
   \begin{align*}
   & a(1-p)^N + (1-a)\sum_{k=0}^N \binom{N}{k} p^k(1-p)^{N-k} \frac{N+1}{N-k+1} \\
   = & a(1-p)^N + (1-a)\sum_{k=0}^N \frac{(N+1)!}{k!(N-k+1)!} (1-p)^{N-k} \\
   = & a(1-p)^N + (1-a)\frac{1}{1-p}(\sum_{k=0}^{N+1} \frac{(N+1)!}{k!(N-k+1)!} (1-p)^{N+1-k} - p^{N+1}) \\
   = & a(1-p)^N + \frac{1-a}{1-p}(1-p^{N+1})
   \end{align*}
   $$

   比较上面两式，当 $a \geq \frac{p-p^{N+1}}{1-(1-p)^{N+1}-p^{N+1}}$ 时，

   $$
   \frac{a}{p}(1-(1-p)^{N+1}) + (1-a)p^{N} \geq a(1-p)^{N} + \frac{1-a}{1-p}(1-p^{N+1})
   $$

   甲的收益较大。
3. 若甲投注 A 获胜两场，收益约为 $\frac{1}{4}(N+1) + \frac{1}{2} \cdot 1 + \frac{1}{4} \cdot 0 \approx \frac{1}{4} N$；若甲投注 A 一胜一负，收益约为 $\frac{1}{4}(N+1) + \frac{1}{4} \cdot 0 + \frac{1}{4}(N+1) + \frac{1}{4} \cdot 0 \approx \frac{1}{2} N$；若甲投注 B 获胜两场，收益约为 $1$。故甲应投注 A 一胜一负。

## 周期四

### T1

> 在橄榄球比赛中，AB为球门线，C, D为AB上两点，CD间的区域为球门。进攻队员将球自AB上球门以外的某点X越过球门线，可达阵得分(try)，并可获得追加射门(conversion)的机会。该队可在过X点的AB的垂线XE上任选一点Y射门。点Y满足何条件时可使 $\angle CYD$ 达到最大。

参考答案:

以CD中点O为坐标原点，AB为x轴建立直角坐标系。

设 C, D 坐标分别为 $(-a, 0), (a, 0)$，X点坐标为 $\left(x_0, 0\right)$。

现欲求 Y点坐标 $\left(x_0, y_0\right)$，使得 $\angle CYD$ 达到最大。

由于Y, C, D 三点共圆，其圆心必在CD的垂直平分线，即y轴上。

设圆心 Z 坐标为 $(0, z)$，则 $\angle CZD = 2\angle CYD$。

故可转化为求点 Z，使得 $\angle CZD$ 达到最大。

此时 Z 应尽量靠近 x 轴，或等价地 $|ZD|$ 尽量地小。

又由于 $|ZD| = |ZY|$，又等价于 $|ZY|$ 尽量地小。

易见 $z = y$ 时，$|ZY|$ 达到最小值 $x_0$。

此时 XE 是圆的切线，过 Y, C, D 三点的圆方程为 $x^2 + (y - y_0)^2 = a^2 + y_0^2$，由于 Y 在圆上，即有 $x_0^2 = a^2 + y_0^2$，Y 点坐标应满足 $y_0^2 = x_0^2 - a^2$。

### T2

> 一折线形机械联动装置 ABCD，A, D 分别固定在 $(-a,0), (a,0)$ 两点，B，C 可活动。
>
> $$
> |AB|=|CD|=\sqrt{2}a, |BC|=2a, P\text{为BC中点。}
> $$
>
> (1) 试求出点 B, C 变化时，P 的轨迹方程 C 及它的参数形式;
>
> (2) 设 O 为 AD 中点，P 为 C 上一点，$\angle POD=\alpha$，求过 P 点 C 的法线与 AD 的夹角。

1. 记 $\angle DAB=\theta, \angle ADC=\varphi, b=\sqrt{2}a$。则 $B, C$ 两点坐标分别为 $(-a+b\cos\theta, -b\sin\theta)$ 和 $(a-b\cos\varphi, b\sin\varphi)$。由

   $$
   \begin{align*}
   4a^{2} &= |BC|^{2} \\
   &= (2a-b(\cos\theta+\cos\varphi))^{2} + b^{2}(\sin\theta+\cos\varphi)^{2} \\
   &= (2a-2b\cos\frac{\theta+\varphi}{2}\cos\frac{\theta-\varphi}{2})^{2} + 4b^{2}\sin^{2}\frac{\theta+\varphi}{2}\cos^{2}\frac{\theta-\varphi}{2} \\
   &= 4a^{2} - 8ab\cos\frac{\theta+\varphi}{2}\cos\frac{\theta-\varphi}{2} + 4b^{2}\cos^{2}\frac{\theta+\varphi}{2}\cos^{2}\frac{\theta-\varphi}{2} + 4b^{2}\sin^{2}\frac{\theta+\varphi}{2}\cos^{2}\frac{\theta-\varphi}{2} \\
   &= 4a^{2} - 8ab\cos\frac{\theta+\varphi}{2}\cos\frac{\theta-\varphi}{2} + 4b^{2}\cos^{2}\frac{\theta-\varphi}{2},
   \end{align*}
   $$

   可知 $b\cos\frac{\theta-\varphi}{2} = 2a\cos\frac{\theta+\varphi}{2}$。

   设 P 点坐标为 $(x, y)$，其中 $x = \frac{b}{2}(\cos\theta - \cos\varphi), y = -\frac{b}{2}(\sin\theta - \sin\varphi)$，则

   $$
   \begin{align*}
   x^2 + y^2 &= \frac{b^2}{4}(2 - 2\cos(\theta - \varphi)) = \frac{b^2}{2}(1 - \cos(\theta - \varphi)) = b^2\sin^2\frac{\theta - \varphi}{2} \\
   x^2 - y^2 &= \frac{b^2}{4}(\cos 2\theta + \cos 2\varphi - 2\cos(\theta + \varphi)) = \frac{b^2}{4}(2\cos(\theta + \varphi)\cos(\theta - \varphi) - 2\cos(\theta + \varphi)) \\
   &= \frac{b^2}{4}\cos(\theta + \varphi)(\cos(\theta - \varphi) - 1)
   \end{align*}
   $$

   因此 $\cos(\theta + \varphi) = \frac{y^{2} - x^{2}}{y^{2} + x^{2}}, \cos\frac{\theta + \varphi^{2}}{2} = \frac{y}{\sqrt{x^{2} + y^{2}}}, \cos\frac{\theta - \varphi}{2} = \frac{2a}{b}\frac{y}{\sqrt{x^{2} + y^{2}}} = \sqrt{2}\frac{y}{\sqrt{x^{2} + y^{2}}}, \sin^{2}\frac{\theta - \varphi}{2} = 1 - \frac{2y^{2}}{x^{2} + y^{2}} = \frac{x^{2} - y^{2}}{x^{2} + y^{2}}$ 即得 P 的轨迹方程 $(x^2 + y^2)^2 = 2a^2(x^2 - y^2)$。

   又由 $x = b\sin\frac{\theta + \varphi}{2}\sin\frac{\varphi - \theta}{2}, y = b\cos\frac{\theta + \varphi}{2}\sin\frac{\varphi - \theta}{2}$ 令 $t = \frac{z}{y} = \tan\frac{\theta + \varphi}{2}$，则 $\cos\frac{\theta - \varphi}{2} = \sqrt{2}\frac{1}{\sqrt{1 + t^{2}}}$，从而 P 的参数方程为

   $$
   \begin{cases}
   x &= \sqrt{2}a\frac{t\sqrt{t^{2} - 1}}{t^{2} + 1}, \\
   y &= \sqrt{2}a\frac{\sqrt{t^{2} - 1}}{t^{2} + 1}
   \end{cases}
   $$
2. 对 P 的轨迹方程用隐函数求导， $2(x^{2} + y^{2})(2x + 2y \cdot y^{\prime}) = 2a^{2}(2x - 2y \cdot y^{\prime})$，即 $y^{\prime} = \frac{x}{y}\frac{a^{2} - x^{2} - y^{2}}{a^{2} + x^{2} + y^{2}}$。故过 $P(x_{0}, y_{0})$ 的法线方程为 $y - y_{0} = \frac{y_{0}}{x_{0} + x_{0}^{2} + y_{0}^{2} - a^{2}}(x - x_{0})$，法线与 x 轴交点 Q 的坐标为 $\left(\frac{2a^{2}x_{0}}{a^{2} + x_{0}^{2} + y_{0}^{2}}, 0\right)$。

   记 $\angle POQ = \alpha, \angle OPQ = \beta$，则 $\sin\alpha = \frac{y_{0}}{\sqrt{x_{0}^{2} + y_{0}^{2}}}$。由正弦定理 $\frac{|PQ|}{\sin\alpha} = \frac{|OQ|}{\sin\beta}$，因此

   $$
   \begin{align*}
   \sin^{2}\beta &= \frac{|OQ|^{2}}{|PQ|^{2}}\sin^{2}\alpha = \frac{\frac{4a^{4}x_{0}^{2}}{(\frac{2a^{2}y_{0}}{a^{2} + x_{0}^{2} + y_{0}^{2}})^{2}}\frac{y_{0}^{2}}{x_{0}^{2} + y_{0}^{2}}}{(\frac{2a^{2}y_{0}}{a^{2} + x_{0}^{2} + y_{0}^{2}} - x_{0})^{2} + y_{0}^{2}} \\
   &= \frac{4a^{4}x_{0}^{2}\frac{y_{0}^{2}}{(a^{2} - x_{0}^{2} - y_{0}^{2})^{2}x_{0}^{2} + (a^{2} + x_{0}^{2} + y_{0}^{2})^{2}y_{0}^{2}}}{(x_{0}^{2} + y_{0}^{2})(a^{4} + 2a^{2}(y_{0}^{2} - x_{0}^{2}) + (x_{0}^{2} + y_{0}^{2})^{2})} \\
   &= \frac{4a^{4}x_{0}^{2}y_{0}^{2}}{(x_{0}^{2} + y_{0}^{2})^{2}} = 4\sin^{2}\alpha\cos^{2}\alpha
   \end{align*}
   $$

   故 $\beta = 2\alpha$。$\angle PQD = \angle POQ + \angle OPQ = 3\alpha$。

## 周期五 学在浙大 轨迹模型



## 周期五 mooc概率模型
