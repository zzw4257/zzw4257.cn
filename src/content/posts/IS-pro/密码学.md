---
title: æ•°æ®å®‰å…¨ä¸å¯†ç å­¦åŸºç¡€ Cheatsheet & Homework
published: 2024-12-15
tags: [note,Crypto,IS]
category: CS
draft: false
image: ./å¼ èªå…”å…”æ‰‹.jpg
description: è¿™æ˜¯ä¸€é—¨éš¾ä»¥è¢«å½’ç±»é‡ç‚¹çš„è¯¾ç¨‹ï¼Œä½ å°†ä¼šä½†ä¸é™äºè§è¯ ç´Šä¹±çš„æ¦‚ç‡è®ºè¡¨è¿°ä½“ç³» + æ‰¾ä¸åˆ°å‡ºå¤„çš„ç»“è®º + å¥‡æ€ªçš„åè¯å†²çª + æ‘¸ä¸ç€å¤´è„‘çš„çŒœæƒ³ + ... ä½†å¸Œæœ›ä½ æ›´åŠ é è¿‘ Cryptography
---
## Reference & Analysis

ã€ŠIntroduction to Modern Cryptographyã€‹

[Introduction-to-modern-cryptography/ç°ä»£å¯†ç å­¦ç®€ä»‹.pdf](https://github.com/Evian-Zhang/Introduction-to-modern-cryptography/blob/master/ç°ä»£å¯†ç å­¦ç®€ä»‹.pdf)

## Contest

### æœŸä¸­

<iframe
  src="/pdfjs-4.6.82-dist/web/viewer.html?file=/file/å¯†ç å­¦æœŸä¸­é¢˜ç›®latexç‰ˆ.pdf"
  width="100%"
  height="800px"></iframe>
></iframe>

## Cheatsheet

éœ€è¦è¯æ˜çš„éƒ¨åˆ†æˆ‘ä¼šç”¨ğŸ™ˆæ ‡å‡ºæ¥

### æœŸä¸­all in one paper

<iframe
  src="/pdfjs-4.6.82-dist/web/viewer.html?file=/file/zzw4257_å¯†ç å­¦_æœŸä¸­å¤ä¹ æ‰‹å†™ç‰ˆ.pdf"
  width="100%"
  height="800px"
></iframe>

### *Intro of Crypto

:::tip[å…³äº Cryptography]

> *kryptÃ³s* `/kryp.tÃ³s/ â†’ /krypËˆtos/ â†’ /kripËˆtos/` è¡¨ç¤º "hidden, secret"

:::

*æŠŠå¾ˆå¤š"ä¸æ–­åŠ æ·±çš„æ¦‚å¿µæ”¾åœ¨è¿™é‡Œ"*

### è§‚å¿µå˜åŒ–

- Gen,Enc,Decä¸å¯æ³„éœ²->å¯æ³„éœ²
  - August Kerchoff 1884 å¯†ç ç³»ç»Ÿåªä¾èµ–å¯†é’¥ï¼Œæ–¹æ³•å¯ä»¥å…¬å¼€
  - "æ”»å‡»è€…ä¸èƒ½è·å–é¢å¤–ä¿¡æ¯"ï¼ˆå…³æ³¨æŸäº›ä½ï¼Œé•¿åº¦è¿™äº›é¢å¤–ä¿¡æ¯ï¼‰
- ä»Shannonå’ŒPerfectè®¤ä¸ºæ”»å‡»è€…æ— é™å¼ºï¼Œåæ¥éƒ½è®¤ä¸º$\mathcal A$æ˜¯PPTçš„
  - ä¸è¦æ±‚ç»å¯¹å‡åŒ€
- ä»çŸ¥è¯†å…ˆäºé›¶çŸ¥è¯†åˆ°é›¶çŸ¥è¯†è„±ç¦»äºçŸ¥è¯†
  - Zero-Knowledge Proof, ZKPï¼Œé™ˆè¿°æŸç§é™ˆè¿°çš„æ­£ç¡®æ€§ï¼Œä¸æ³„æ¼ä»»ä½•é™ˆè¿°æœ¬èº«ä¿¡æ¯
  - åè®®ä¸­é‡è¦ä½œç”¨
- ä¼ ç»Ÿå¯†ç å­¦
  - å¤©æ‰cracked game
  - Caesar Cipher (Genæ— éšæœºæ€§)
  - Substitution Cipher æ”¹æˆéšæœºæ’åˆ—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¼•å…¥

å‡¯æ’’å¯†ç å’Œå˜å½¢

### åŸåˆ™

- å¯ç”¨æ€§
  - $\mathbb P[\mathrm{Dec}(\mathrm{Enc}(x))=x]=1$
- æ­£ç¡®æ€§
- å®‰å…¨æ€§

å¯¹æˆ‘ä»¬å…³æ³¨çš„Provable Security

- *Precise Definition of Security*
- *Mathematic Assumpation*
- *Security Proofâ€”â€”Reduction*

### Crypto Principles

:::note[åŸºç¡€æ¬¾åŠ å¯†ç³»ç»Ÿå®šä¹‰]

$\{\mathrm{Gen,Enc,Dec,M,K}\}$

- $\mathrm{GEN}(srand)=sk$ (randomized from K)
- $\mathrm {ENC}(sk,M)=C$ (R/D)
- $\mathrm{DECO}(sk,C)=D$ (deterministic)

:::

#### **Secure Multi-Party Computation**

è®¡ç®—ä¸€ä¸ªå…³äºç§˜å¯†è¾“å…¥ $x_1, \dots, x_n$ çš„å‡½æ•° $f$ ã€‚åœ¨è®¡ç®— $f(x_1, \dots, x_n)$ æ—¶ï¼Œå„æ–¹å¸Œæœ›åœ¨ä¸æ³„éœ²ä»»ä½•é¢å¤–ä¿¡æ¯çš„æƒ…å†µä¸‹å®Œæˆè®¡ç®—ï¼ŒåŒ…æ‹¬å„æ–¹çš„ç§˜å¯†è¾“å…¥ã€‚é’ˆå¯¹ f çš„ MPC åè®® $\pi$ å…·æœ‰ä»¥ä¸‹å±æ€§ï¼š

- **æ­£ç¡®æ€§ (Correctness)**ï¼šæ‰§è¡Œåè®® $\pi$ åï¼Œæ‰€æœ‰å‚ä¸æ–¹éƒ½èƒ½å¾—å‡º $f(x_1, \dots, x_n)$ çš„å€¼ã€‚
- .**å®Œç¾çš„ã€è¯šå®ä½†å¥½å¥‡çš„** t **-ä¸²é€šå®‰å…¨æ€§ (t-security)**ï¼šè®¾ $[n]$ è¡¨ç¤ºå‚ä¸æ–¹é›†åˆ $\{1, \dots, n\}$ ï¼Œ $t$ è¡¨ç¤ºä¸²é€šçš„å¯¹æ‰‹æ–¹æ•°é‡ã€‚

å¯¹äºæ‰€æœ‰å¤§å°ä¸º t çš„é›†åˆ $S \subseteq [n]$ ï¼Œå­˜åœ¨ä¸€ä¸ªæ¨¡æ‹Ÿå™¨ $\text{Sim}$ ï¼Œä½¿å¾—å¯¹äºæ‰€æœ‰ $x_1, \dots, x_n$ ï¼š

$\text{View}_S(\pi(x_1, \dots, x_n)) \equiv \text{Sim}(x_S, f(x_1, \dots, x_n))$

å…¶ä¸­ï¼Œ$ \text{View}_S(\pi(x_1, \dots, x_n)) $è¡¨ç¤ºå‚ä¸æ–¹ $i$ $\in$ $S$ åœ¨åè®®æ‰§è¡ŒæœŸé—´çš„å¯è§‚æµ‹çŠ¶æ€ã€‚

:::note[éè¯šå‹¿æ‰°çš„ä¾‹å­ï¼ˆï¼Ÿï¼‰]

ä¸¤ä¸ªäººå‡ºç¤º0/1çŠ¶æ€ï¼Œå¦‚ä½•è®¾è®¡åè®®ä½¿å¾—ä¸¤ä¸ªäºº**åœ¨è¯šä¿¡æƒ…å†µä¸‹**ä»…èƒ½è·å–æ˜¯å¦åŒä¸º1çš„ç»“æœï¼ˆèˆ”ç‹—å¦‚ä½•ä¿æŠ¤è‡ªå·±ï¼‰

è®¾è®¡è¡¨æ ¼

|   | A  | B  |
| - | -- | -- |
| 1 | 01 | 10 |
| 0 | 10 | 01 |

ç„¶åæŒ‰ç…§ sa|1|sb çš„æ–¹å¼è¿æ¥æˆç¯

å®¹æ˜“å‘ç°ï¼Œåªæœ‰11çš„æƒ…å†µæ˜¯æœ‰é•¿åº¦ä¸º3çš„1è¿ç»­æ®µçš„

:::

### Shannon/Perfect Privacy

ä»‹ç»é¦™å†œ/å®Œç¾å®‰å…¨äº’åŒ–ï¼Œå¹¶é™ˆè¿°å…¶å±€é™æ€§ã€‚æœ¬è´¨æ˜¯åŸºäºçº¯éšæœºçš„ç­‰ä»·æ¦‚ç‡åˆ†å¸ƒçš„ç”Ÿæˆã€‚

### Shannon vs Perfect

:::important[ä¸¤ä¸ªå½¢å¼]

Shannon $\forall t,c,\mathbb P_{m\leftarrow D}[m=t]=\mathbb P_{m\leftarrow D,sk\leftarrow \mathrm{Gen}}[m=t\mid \mathrm{Enc}(sk,m)=c]$

Perfect $\forall m_1,m_2,\mathbb P_{sk\leftarrow \mathrm{Gen}}[\mathrm{Enc}(sk,m1)=c]=\mathbb P_{sk\leftarrow \mathrm{Gen}}[\mathrm{Enc}(sk,m2)=c]]$

:::

:::note[Theorem]

ä¸Šè¿°å®šä¹‰ç­‰ä»·ğŸ™ˆ

Hint:å…¨æ¦‚ç‡å±•å¼€

:::

æœ‰ä¸€ä¸ªæ¨è®º

:::tip[Shannon's theorem]

å‡è®¾$|M|=|K|=|C|$ï¼Œåˆ™æˆ‘ä»¬æœ‰å®Œç¾å®‰å…¨ç­‰ä»·äº$k$æ¦‚ç‡å‡åŒ€åˆ†å¸ƒ,$\mathrm{Enc}(k,m)=c$ï¼Œå¯¹äºç»™å®šçš„$m,c$,$k$æ˜¯å”¯ä¸€çš„

:::

#### One Time pad

$$
M=\{0,1\}^n=K\\\mathrm{Gen}(\cdot)\to sk,sk\xleftarrow {\not\$}K\\\mathrm{Enc}(sk,m)=sk\oplus m\\\mathrm{Dec}(sk,m)=sk\oplus c
$$

æ˜¾ç„¶æœ‰$\mathbb P_{sk}[sk\oplus m=c]=\mathbb P_{sk}[sk=m\oplus c]$,è¿™é‡Œå‡ºä¸€ä¸ªé—®é¢˜ï¼Œé•¿å¯†é’¥ä¿æŠ¤çŸ­å†…å®¹

OTPæ˜¯Shannon-secureçš„

:::note[Theorem]

é¦™å†œå®‰å…¨å¿…å®šæœ‰$|K|\geqslant |M|$ğŸ™ˆ

Hint:ä»æ˜ å°„ä¸å®Œå…¨æ€§å‡ºå‘

:::

### One-way function

:::note[Turing machine å‡è®¾]

$\mathcal M$æ˜¯ä¸€ä¸ª**å›¾çµæœº**ï¼Œ$T(\mathcal M)$è¡¨ç¤º$\forall \mathbf x\in \{0,1\}^*$ ï¼Œ$\mathcal M$ä¼šåœ¨$T(|x|)$å†…åœä¸‹

$\mathcal A$:efficient adversary ,å…¶æ»¡è¶³PPT(éšæœºæ€§å¤šé¡¹å¼æ—¶é—´)ï¼Œå³æ”»å‡»åŠ›æœ‰é™

æœ€åå¼ºè°ƒä¸€ä¸‹ï¼Œ$n$æ˜¯æ•°æ®é‡è§„æ¨¡ï¼Œä¸æ˜¯æ•°æ®ä¸ªæ•°ï¼Œå¤§æ•°çš„è´¡çŒ®æ˜¯ä½æ•°

:::

- **Worst one-way function**

  - easy to compute $\exist \mathcal M(P),\forall x\in\{0,1\}^*,\mathcal M(x)=f(x)$
  - hard to invert, ä¸å­˜åœ¨ $\mathcal A$, $\mathbb P[A(f(x))=t\mid f(x)=f(t)]=1$
- **strong one-way function**(é»˜è®¤å‡æŒ‡è¿™ä¸ª)

  - $\forall \mathcal A^r,\mathbb P_{x,r}[A(f(x))=t\mid f(x)=f(t)]\leqslant \mathtt {negl}(n)$
- ***weak one-way function**(å…¶å®ä¸ç®¡ï¼Œæ¯”è¾ƒå¤æ‚ï¼ŒOWFæ˜¯ä¸€ä¸ªfamily)

  - $\forall \mathcal A^r,\mathbb P_{x,r}[A(f(x))=t\mid f(x)=f(t)]\leqslant 1-\frac{1}{\mathrm{poly}}$

:::note[eg]

è®¾$\mathcal P_n$ è¡¨ç¤º $\mathcal P \cap [2^{n-1},2^{n}-1]$å³äºŒè¿›åˆ¶ä¸º$n$ä½çš„ç´ æ•°é›†åˆ

$f:\mathcal P_n\times \mathcal P_n\to \{0,1\}^{2n}$ä¸ºä¸€ä¸ªOWF

ç”±ç´ æ•°å®šç†$\pi(n)\approx\frac{n}{\ln n}$

$|\mathcal P_n|=\pi (2^n)\approx\frac{2^n}{n}$

$$
\begin{align*}
\forall \mathcal A^r,\mathbb P_{x,r}[\mathcal A(f(x))=t\mid f(x)=f(t)]&=\mathbb P_{(p,q)\xleftarrow{\$}\mathcal P_n\times \mathcal P_n}[\mathcal A (z)=(p',q')\mid p'q'=pq=z]\
\\&=\mathbb P_{(p,q)\xleftarrow{\$}\mathcal P_n\times \mathcal P_n}[\mathcal A (z)=pq]=\mathtt {negl}(n)
\end{align*}
$$

ä¹Ÿå³å¤§æ•°åˆ†è§£çš„æ¦‚ç‡

è¿™é‡Œå¼ èªä¸Šè¯¾è¯´é”™äº†ï¼Œä¸èƒ½ç›´æ¥ç”¨ç´ æ•°å¯†åº¦å®šç†ç›´æ¥è¯´æ˜è¿™ä¸ªOWFæ€§è´¨

æ¢ä¸€ä¸ª

$g:\mathcal \{0,1\}^n \times \{0,1\}^n\to \{0,1\}^{2n}:g(x,y)=xy$

è¿™ä¸ªæ˜¾ç„¶å°±ä¸æ˜¯strong OWF

æˆ‘ä»¬å–$\mathcal P_n\times \mathcal P_n\subseteq \{0,1\}^n\times  \{0,1\}^n$ï¼Œè¿™éƒ¨åˆ†é€‰å–æ¦‚ç‡ä¸º

$\mathbb P[(x,y)\in \mathcal P_n\times \mathcal P_n]=\frac{|\mathcal P_n|^2}{2^{2n}}\approx\frac{1}{4n^2}$

åˆ™

$$
\mathbb P_{(p,q)\xleftarrow{\$}\{0,1\}^n\times \{0,1\}^n}[\mathcal A (z)=(p',q')\mid p'q'=pq=z]\leqslant 1-\frac{1}{4n^2}
$$

è¿™é‡Œæˆ‘è·³æ­¥äº†

:::

:::important[hc]

ç»™å®šä¸€ä¸ªå‡½æ•° $f$ ï¼Œè‹¥å­˜åœ¨ä¸€ä¸ªå‡½æ•° $\text{hc} : \{0,1\}^* \rightarrow \{0,1\}$ æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼Œåˆ™ç§° \text{hc} æ˜¯ f çš„hard-core predictï¼š

- **å¯è®¡ç®—æ€§**ï¼š

  $$
  \text{hc}
  $$

  å¯ä»¥åœ¨å¤šé¡¹å¼æ—¶é—´å†…è®¡ç®—ã€‚
- **éš¾ä»¥é¢„æµ‹æ€§**ï¼šå¯¹äºä»»æ„æ¦‚ç‡å¤šé¡¹å¼æ—¶é—´ç®—æ³•

  $$
  \mathcal A
  $$

  ï¼Œå­˜åœ¨ä¸€ä¸ªå¯å¿½ç•¥å‡½æ•°

  $$
  \text{negl}(n)
  $$

  ï¼Œä½¿å¾—

$$
\mathbb P_{x \leftarrow {0,1}^n} \left[ \mathcal A(1^n, f(x)) = \text{hc}(x) \right] \leq \frac{1}{2} + \text{negl}(n)
$$

:::

### PRG

:::tip[stream password]

é­”æ”¹OTP

$$
\begin{align*}\mathrm{Gen}(1^n)&\to seed \overset{\$}{\leftarrow} \{0,1\}^n\\\mathrm{Enc}(seed,m)&\to sk\oplus m\\\mathrm{Dec}(seed,c)&\to sk\oplus c\end{align*}
$$

:::

è¿™é‡Œéœ€è¦ä¸€ä¸ª**æ··æ·†**seedå’Œskçš„ä¸œè¥¿

å¼•å…¥ä¸€ä¸ªè¡¥å……æ¦‚å¿µ

:::note[EAV-secure/Semantic Security]

$$
\forall \mathcal A^r,i,\mathbb P[\mathcal A(1^n,\mathrm{Enc}(sk,m))=m_i]\leqslant \frac{1}{2}+\mathtt {negl}(n)
$$

å®è´¨ä¸Šå°±æ˜¯æˆ‘ä»¬ä¸èƒ½å¤Ÿé€šè¿‡å¯¹äºåŠ å¯†ç»“æœçš„åˆ†æè·å–å¯¹äºæ•°æ®ä»»æ„å­—æ®µçš„ä¿¡æ¯

:::

ç®€å•æè¿°ä¸‹PRGåŸºäºçš„æ¸¸æˆè¿‡ç¨‹

$$
ch\xrightarrow []{n,\mathrm {Gen,Enc,Dec}}\mathcal A\\
\mathcal A\xrightarrow {m_0,m_1,|m_0|=|m_1|}ch\\
ch\xrightarrow [b\leftarrow \{0,1\},sk\leftarrow \mathrm{Gen}(1^n )]{\mathrm{Enc(sk,m_b)}}\mathcal A\\
\mathcal A \xrightarrow {b'}ch
$$

ä¸€å¥è¯å°±æ˜¯Aæ— æ³•ä¾èµ–chç»™å‡ºçš„åŠ å¯†èŒƒå¼ï¼ŒåŒºåˆ†è‡ªå·±æä¾›çš„(ä¹Ÿå°±æ˜¯ä»»æ„çš„)å¯†æ–‡åŠ å¯†åçš„ç»“æœ

ç»™äºˆä¸€äº›é¢å¤–çš„æ•°å­¦åŸç†æˆ‘ä»¬å³

:::note[EVA-another definition]

$\pi = (\mathrm{Enc},\mathrm{Dec})$ os EVA iff:

$$
\forall \mathcal A^r,f:\{0,1\}^n\to \{0,1\},\mathcal D,\exist \mathcal A' \\\left|\mathbb P[\mathcal A(1^n,\mathrm{Enc}(sk,m))=f(m)]-\mathcal A'(1^n)=f(m)\right|\leqslant \mathtt {negl}(n)
$$

:::

ä¾èµ–ä¸Šè¿°è¿‡ç¨‹æˆ‘ä»¬å¯ä»¥ç»™å‡ºPRGçš„æ ‡å‡†å®šä¹‰

:::important[PRG def]

è®¾ $G:1^n\to 1^{l(n)}$ ï¼Œåˆ™å…¶ä¸ºä¸€ä¸ªä¼ªéšæœºç”Ÿæˆå™¨çš„å……è¦æ¡ä»¶ä¸º(è¿™é‡Œæˆ‘ä¸ºäº†ä¸€è‡´æ€§ï¼Œæ‡’å¾—åŒºåˆ†è¿™é‡Œçš„$\mathcal D$å’Œ$\mathcal A$äº†ï¼Œå‡è®¾ä½ ä¹æ„å¯ä»¥è‡ªè¡ŒåŒºåˆ†)

$$
\forall \mathcal A^r:\{0,1\}^{l(n)}\xrightarrow{PPT} \{0,1\},\left|\Pr_{s \leftarrow \{0,1\}^n, r \leftarrow G(s)}[\mathcal A(r)=1]-\Pr_{r \xleftarrow{\$}\{0,1\}^{l(n)}}[\mathcal A(r)=1]\right| \leq \mathtt{negl}(n)
$$

:::

è¿™é‡Œæœ‰ä¸€ä¸ªå¤–åŒ…ä»»åŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥ä¾èµ–EVA-secureçš„æ¸¸æˆå½¢å¼æ„é€ reduction

åœ¨PRGä¸­ï¼Œæˆ‘ä»¬å¾€è¿™ä¸ªæœ‰äº›ä¸€åŠä¸¢å‡åŒ€åˆ†å¸ƒï¼Œä¸€èˆ¬ä¸¢$G(x)$ç”Ÿæˆçš„åˆ†å¸ƒï¼Œ$\mathcal A'$çš„ä¼˜åŠ¿å¯å¿½ç•¥

![image-20241105103551795](/pic/crypto/1.png)

#### PRG chain(hybrid argument)

è¿™é‡Œæˆ‘ä»¬å…ˆç»™å‡ºå°½é‡ä¸¥è°¨çš„è®ºè¿°

:::note[PRGå¯æ‰©å±•å®šç†]

å‡è®¾$G:\{0,1\}^n\to \{0,1\}^{n+1}$ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥å¯¹ä»»æ„$\mathrm{poly}(n)$ç”Ÿæˆ$\hat G :\{0,1\}^n\to \{0,1\}^{\mathrm{poly(n)}}$

è¿™é‡Œæˆ‘ä¸çŸ¥é“ä¸ºä»€ä¹ˆè€å¸ˆè¦å–$\mathrm {poly}(n)=2n$ï¼Œä¹Ÿä¸çŸ¥é“æœ‰ä»€ä¹ˆç‰¹æ®Šæ€§ï¼Œæ³¨æ„è¿™é‡Œåƒä¸‡ä¸è¦è®¤ä¸ºè¿™ä¸ªè¿­ä»£è¿‡ç¨‹å¯ä»¥æ— é™ï¼Œæ¢å¥è¯è¿™ä¸ªè¿­ä»£è¿‡ç¨‹çš„æ¬¡æ•°å…³äº$n$ä¸ºå¸¸æ•°

![image-20241105105554392](/pic/crypto/2.png)

:::

ä¸Šè¿°è¯æ˜ç§°ä¸º hybrid argument è¿™é‡Œä¸åšè§£é‡Š (P282)

### Multi-message-secure

å®¹æ˜“å‘ç°æˆ‘ä»¬ä¹‹å‰æ„é€ çš„æµå¯†ç ï¼Œç¼©çŸ­äº†skä½†æ˜¯è¿˜æ˜¯åªèƒ½ä¸€æ¬¡ä¸€å¯†ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å¼‚æˆ–çš„å¯é€†æ€§æ„é€ å†²æ’ï¼Œè·å–é¢å¤–ä¿¡æ¯ï¼Œè€ƒè™‘ä¸‹é¢çš„æ¸¸æˆ

$$
ch\overset{\overset{\mathrm{
Gen,Enc,Dec}}{\to } }{\tiny{M_0,M_1}}A\\\\ch\overset{\overset{(M_{0,1}\cdots M_{0,k}),(M_{1,1}\cdots M_{1,k})}{\leftarrow}}{\tiny \mathrm {Enc}(sk,M_b)} A\\ch\xleftrightarrow[b']{\{\mathrm{Enc}(M_{b,*})\}}\mathcal A
$$

å½“æˆ‘ä»¬æä¾›æ¥é€‰æ‹©çš„æ¶ˆæ¯ä¸ºé˜µåˆ—æ—¶ï¼Œæƒ…å†µæœ‰æ‰€ä¸åŒ

ä¸‹é¢ç»™å‡ºäº†ä¸€ç§æ–¹æ¡ˆ

$$
\mathrm{Enc}(sk,m,r)\to (G(sk||r)\oplus M,r)\to (c_1,c_2)\\
\mathrm{Dec}(sk,c_1,c_2)\to G(sk||c_2)\oplus c_1
$$

åœ¨è¿™ä¸ªæ„ä¹‰ä¸Šï¼Œæˆ‘ä»¬æ³„éœ²äº†ä¸€éƒ¨åˆ†$sk'$,è¾¾æˆäº†å®‰å…¨æ€§

### IND-CPA

> **IND-CPA**:*indistinguishabable* c*hosen-plaintext-attacks*

ä»è¿™ä¸ªå‡ºå‘

- Initial Phase

$$
ch\xrightarrow {\mathrm{Gen,Enc,Dec}}A\\
$$

ç„¶åæ‰§è¡Œå¤šè½®

$$
ch\xleftrightarrow [\mathrm{Enc}_{sk}(m_i)]{m_i}A\\
$$

è¿™è®°ä¸ºPhase1

- challaenge  Phase(æ³¨æ„è¿™ç§äºŒæ‹©ä¸€çš„åªæœ‰ä¸€æ¬¡)

$$
ch\xleftrightarrow [\mathrm{Enc}_{sk}(m^*_{b})]{m^*_{1},m_{2}^*}A\\
$$

- Phase2

$$
ch\xleftrightarrow [\mathrm{Enc}_{sk}(m_i)]{m_i}A\\
$$

æœ€åçŒœ$b'$

ä¸‹é¢æˆ‘ä»¬è€ƒè™‘è¯´æ˜IND-CPAä¸Multi-Msg-Secure çš„å…³ç³»

å›é¡¾Multi-Msg $\mathsf {Privk}^{\mathrm{mult}}_{\mathcal A,\mathrm{II}} (n)$

$$
ch\overset{\overset{\mathrm{
Gen,Enc,Dec}}{\to } }{\tiny{M_0,M_1}}A\\\\ch\overset{\overset{(M_{0,1}\cdots M_{0,k}),(M_{1,1}\cdots M_{1,k})}{\leftarrow}}{\tiny \mathrm {Enc}(sk,M_b)} A
$$

---

åœ¨æœ¬é¢˜ä¸­çš„IND-CPAèŒƒå¼å®é™…ä¸Šå¯ä»¥ç”¨æ›´å¼ºå½¢å¼è¡¨ç¤º CPA2

CPA2â†’Multi-Msg Sæ˜¾ç„¶

æ¯æ¬¡éƒ½å¯ä»¥é—®$m_{i,0/1}$ç„¶åå›ç­”$\mathrm{Enc}(m_{i,b})$

æ¢å¥è¯å¯¹è¿™ä¸ªCPAï¼Œå…¶é—®é¢˜éƒ½å½¢å¦‚

$$
ch\xleftrightarrow [\mathrm{Enc}_{sk}(m^*_{i,b})]{m^*_{i,1},m_{i,2}^*}A\\
$$

CPA2â†’CPAå¯ä»¥ç›´æ¥å°†äºŒæ‹©ä¸€çš„é—®å˜æˆç¡®å®šé—®ï¼Œè¿™ä¸ªreduceæ˜¯æ˜¾ç„¶çš„

CPAâ†’CPA2æ˜¯æ„é€ ä¸€ä¸ªhybrid argument

1ä¸ªpoweræ€ä¹ˆæ‰©å±•

ç”¨CPAæ¥å‹¾è¿b=0åˆ°b=1

è¿™é‡Œæˆ‘æ„Ÿæ€§çš„æè¿°ä¸‹è¿™ä¸ªGame set

Game0:

åˆ†åˆ«é—®ï¼Œ$(m_{10},m_{11}),\cdots(m_{i0},m_{i1})$ï¼Œå…¨éƒ¨å›ç­”$b_i=0$

Game1:

åˆ†åˆ«é—®ï¼Œ$(m_{10},m_{11}),\cdots(m_{i0},m_{i1})$ï¼Œé™¤äº†ç¬¬ä¸€ä¸ªå…¨éƒ¨å›ç­”$b_i=0$

Game2:

åˆ†åˆ«é—®ï¼Œ$(m_{10},m_{11}),\cdots(m_{i0},m_{i1})$ï¼Œé™¤äº†å‰ä¸¤ä¸ªå…¨éƒ¨å›ç­”$b_i=0$

â€¦

ä¸€å¥è¯ï¼Œä½ æœ€åæ˜¯å¸Œæœ›åŒºåˆ†å…¨0å’Œå…¨1

ä¸Šé¢$Game_i$å’Œ$Game_{i+1}$æœ¬è´¨ä¸Šå°±æ˜¯å‰ç¼€çš„1å¤šäº†ä¸€ä¸ªä¸€ä½ï¼Œèƒ½åˆ©ç”¨CPAæ¥åˆ†ç•Œæ­æ¡¥ï¼ˆæ–°å¼•å…¥çš„ä¸€ä½æ˜¯challange phaseï¼‰ï¼Œæœ€åå°±èƒ½æ­ä¸€ä¸ªé•¿æ¡¥

### PRFs

å¯¹äº

$$
\mathcal F=F(\{0,1\}^n,\{0,1\}^n)
$$

æˆ‘ä»¬æœ‰$|\mathcal F|=(2^n)^{2^n}$,è¿™é‡Œæˆ‘ä»¬å¸Œæœ›èƒ½å¤Ÿéšä¾¿é€‰å–ä¸€ä¸ª$F_I$ï¼Œä½†æ˜¾ç„¶è¿™ä¸ªéšæœºç”Ÿæˆçš„ä»£ä»·å¤ªå¤§ï¼Œè¿™é‡Œæˆ‘ä»¬å¼•å…¥

:::note[PRFs]

$\mathcal F_I$ä¸ºä¸€ä¸ªè¢«$I$ç´¢å¼•çš„æ˜ å°„é›†åˆï¼ˆé¢˜åº“ï¼‰ï¼Œå…¶æ˜¯ä¼ªéšæœºçš„å½“ä¸”ä»…å½“æ¸¸æˆæˆç«‹

ché¦–å…ˆæŠŠ$\mathcal F_I$ç»™A

ç„¶åchè‡ªå·±åœ¨$I$é‡Œé¢é€‰ä¸€ä¸ªsk,$b$éšä¾¿å®š

ç„¶åAåå¤é—®$m_1$,chæ ¹æ®$b$åå¤å›ç­”$F_{sk}(m_i)$æˆ–$y_i$

$\mathbb P[b=b']=\frac{1}{2}+\mathtt{negl}(n)$

:::

æ›´å½¢å¼åŒ–

$$
\left|\mathbb P[\mathcal D(F_{sk}(1^n)=1)]-\mathbb P[\mathcal D(f(1^n)=1)]\right|\leqslant \mathtt{negl}(n)
$$

#### IND-CPA 2 PRFs

$$
\mathrm{Gen}(1')\to sk,\{\mathcal F\}_I\\\mathrm{Enc}(sk,m,r)=(r,F_{sk}(r)\oplus m)\\\mathrm{Dec}(sk,c_1,c_2)=c_2\oplus F_{sk}(r)
$$

#### PRFs 2 IND-CPA

å¯¹Reductionå±‚é¢

chç»™R $\mathcal F_I$ï¼Œè‡ªå·±ç”Ÿæˆ$sk$

RåŸºäºå®šä¹‰ç”Ÿæˆ$\mathrm{Gen.Enc,Dec}$ç»™A

Aä¸¢å›å»$m_1$,Ré¡ºå¸¦ç»™å‡º$r_1$,chå›ç­”$str_1$

ç„¶åRâ†’$(r_1,str_1\oplus m_1)$â†’A

â€¦

æ¥Aå‘å‡ºä¸€æ¬¡çµé­‚challenge

ç»™$m_0^*,m_1^*$ï¼Œç„¶åè¿”å›ä¸€ä¸ª

$\mathrm{Enc}(m_d^*)$,çŒœæµ‹æ­£ç¡®ä¸å¦å¯¹åº”$b'=0/1$,å†å›å»å¯¹ç…§$b$

#### PRG 2 PRFs

è¿˜æ˜¯hybrid argument

![image-20241105112820050](/pic/crypto/3.png)

ç›¸å½“äºä½ éœ€è¦ä»$[0,2^n)$å…¨$0â†’[0,2^n)$å…¨1

é¦–å…ˆæˆ‘ä»¬å‡å®š$G$æ˜¯PRG

Game0:all G

Game1:Gä½†æ˜¯å±‚1å

Game1:Gä½†æ˜¯å±‚1,2å

â€¦

è¿™é‡Œä¸€ä¸ªé—®é¢˜æ˜¯Game n-1:n è¿™ä¸ªé—´éš”æœ‰$2^{n-1}$ï¼Œæ˜¯ä¸èƒ½ç”¨hybrid argument

æ˜¾ç„¶æˆ‘ä»¬æ˜¯æ±‚è§£å…·ä½“ä¸€ä¸ª$\mathcal O(q)$çš„å‘é—®ï¼Œå› æ­¤å®Œå–„è¿™éƒ¨åˆ†å³å¯

#### PRFs 2 PRG

è¿™ä¸ªæ˜¯æ˜¾ç„¶çš„ï¼Œä¸€ä½ä¸€ä½å³å¯

### PRPs

:::note[PRPs]

$\mathcal P_I$ä¸ºä¸€ä¸ªè¢«$I$ç´¢å¼•çš„æ˜ å°„é›†åˆï¼ˆé¢˜åº“ï¼‰ï¼Œå…¶æ˜¯ä¼ªéšæœºçš„å½“ä¸”ä»…å½“æ¸¸æˆæˆç«‹

ché¦–å…ˆæŠŠ$\mathcal P_I$ç»™A

ç„¶åchè‡ªå·±åœ¨$I$é‡Œé¢é€‰ä¸€ä¸ªsk,$b$éšä¾¿å®š

ç„¶åAåå¤é—®$(m_0,\mathcal P)$æˆ–è€…$(m_1,\mathcal P^{-1})$ï¼Œç„¶åAè¿™è¾¹æ ¹æ®é—®é¢˜å›ç­”

$\mathbb P[b=b']=\frac{1}{2}+\mathtt{negl}(n)$

:::

å½¢å¼åŒ–å®šä¹‰å¦‚ä¸‹

$$
\left|\mathbb P[\mathcal D(P_{sk}(1^n)=1)]-\mathbb P[\mathcal D(\pi(1^n)=1)]\right|\leqslant \mathtt{negl}(n)\\
\left|\mathbb P[\mathcal D(P^{-1}_{sk}(1^n)=1)]-\mathbb P[\mathcal D(\pi^{-1}(1^n)=1)]\right|\leqslant \mathtt{negl}(n)
$$

#### Cipher-Block-Chaining

$$
\mathrm {Enc}(m,sk,r)=(r,F_{sk}\oplus m)
$$

æˆ‘ä»¬å¸Œæœ›èŠ‚çœskç”Ÿæˆçš„å¼€é”€

ä¸€ä¸ªå¾ªç¯åˆ©ç”¨çš„æƒ³æ³•åº”è¿è€Œç”Ÿ

$$
\mathrm{Enc}(sk,m_1||m_2||\cdots m_t,r)=(r,F_{sk}(r)\oplus m_1,F_{sk}(c_1)\oplus m_2,\cdots,F_{sk}(c_{t-1})\oplus m_t)
$$

ä½†æ˜¾ç„¶è¿™é‡Œ$F$ç”¨åˆ°äº†å¼‚æˆ–å¯é€†çš„æ€§è´¨ï¼Œå› æ­¤æ›´ä¸€èˆ¬çš„æˆ‘ä»¬éœ€è¦ç»™å‡ºPRPsï¼Œå®ç°$(r,P_k(m,r))\leftrightarrow m$

- CBC
- OFB
- CTR

### MAC

è¿™éƒ¨åˆ†æˆ‘ä»¬æš‚æ—¶ä¸çœ‹æœºå¯†æ€§ï¼Œæˆ‘ä»¬å¼€å§‹å…³æ³¨å¯ä¿¡æ€§

$$
\mathrm{MAC}(sk,m)\to \tau,(m,\tau)
$$

> çœŸå®çš„æ•°å­—ç­¾åæ²¡æœ‰sk

æ”»å‡»è€…å¿…é¡»ä»¿é€ $(m',\tau')$

**unforgeability chosen message attackï¼ˆUCMAï¼‰**

> UCMAæ¨¡å‹çš„å®‰å…¨æ€§é€šå¸¸ä¸æ•°å­—ç­¾åçš„**å­˜åœ¨æ€§ä¸å¯ä¼ªé€ æ€§ï¼ˆExistential Unforgeabilityï¼‰ç›¸å…³è”ã€‚å¦‚æœä¸€ä¸ªæ•°å­—ç­¾åæ–¹æ¡ˆåœ¨UCMAæ¨¡å‹ä¸‹æ˜¯å®‰å…¨çš„ï¼Œé‚£ä¹ˆå¯ä»¥è®¤ä¸ºè¯¥æ–¹æ¡ˆå…·æœ‰EUF-CMA**ï¼ˆExistential Unforgeability under Chosen Message Attacksï¼‰çš„å®‰å…¨æ€§

æ•´ä½“æ€è·¯æ˜¯è®¾è®¡

$$
\begin{cases}\mathrm{Gen}(1^n)\to sk\\\mathrm{MAC}(sk,m)\to \tau\\\mathrm{Verify}(sk,\tau,m)\in \{0,1\}\end{cases}
$$

$$
ch\xrightarrow {\mathrm{Gen,MAC,Verify}} \mathcal A\\ch\xleftrightharpoons[\mathrm{MAC}_{sk}(m_1)/\mathrm{Verify_{sk}}(m_1)]{\mathrm{m_1}/(m_1,\tau_1)} \mathcal A\\\cdots\\ch\xleftrightharpoons[\mathrm{MAC}_{sk}(m_t)]{\mathrm{m_t}} \mathcal A\\ch\xleftarrow[\tau^*]{\mathrm{m^*}} \mathcal A
$$

$\mathbb P[A~wins]=\mathbb P[\mathrm{Verify(m^*,\tau^*)}=1]=\mathtt{negl}(n)$

æ³¨æ„$\mathcal A$è¿™æ¬¡å¼€æŒ‚äº†ï¼Œç›¸å½“äºæœ¬åœ°å¯ä»¥ä¸€ç›´è·‘ï¼Œè·‘å¥½äº†æ‰æ‰¾äºº

## å¯†ç å­¦ä½œä¸š

### ç¬¬ä¸€æ¬¡ä½œä¸š One Time Pad & OWF & PRG

è¿™ä¸€èŠ‚ä½œä¸šæ²¡æœ‰æ›´æ–°å‹˜è¯¯ï¼Œå› æ­¤çœ‹ä¸ªå¤§æ¦‚å°±è¡Œï¼Œæ‡’å¾—æ”¹æˆæäº¤çš„ç‰ˆæœ¬

#### Question 1: A Flawed One-Time Pad

:::note[Description]
Consider a variant of the one-time pad with message space $\{0, 1\}^n$, where $n$ is an odd integer, and the secret key space is restricted to all $n$-bit strings with an even number of 1's. Construct an efficient adversary that compromises perfect secrecy.
:::

**Answer:**

Let the key set be denoted by $K$: $|K|=\sum _{i=0}^{n-1}\binom{n}{i}=2^{n-1}$

For any $m_1$ with an odd number of 1's and any $m_2$ with an even number of 1's, since $n$ is odd, we have

$$
\Pr_{sk}[m_1 \oplus sk = c] = 
\begin{cases}
    \frac{1}{2^{n-1}} & \text{if } \text{pop\_count}(c) \not\equiv 0 \mod 2\\
    0 & \text{if } \text{pop\_count}(c) \equiv 0 \mod 2
\end{cases}
$$

Similarly,

$$
\Pr_{sk}[m_2 \oplus sk = c] = 
\begin{cases}
    \frac{1}{2^{n-1}} & \text{if } \text{pop\_count}(c) \equiv 0 \mod 2\\
    0 & \text{if } \text{pop\_count}(c) \not\equiv 0 \mod 2
\end{cases}
$$

Thus, an adversary can determine the parity (odd or even) of the number of 1's in the original message by examining the ciphertext $c$. This additional information compromises perfect secrecy.

**Idea:**

The original One-Time Pad encryption and decryption processes are defined as follows:

$$
M = \{0,1\}^n = K \\
\text{Gen}(\cdot) \to sk, sk \overset{\$}{\leftarrow} K\\
\text{Enc}(sk, m) = sk \oplus m \\
\text{Dec}(sk, c) = sk \oplus c
$$

Under the condition that $sk$ is uniformly random, the probability of encrypting $m_1$ and $m_2$ to the same ciphertext $c$ is equal, i.e.,

$$
\Pr_{sk}[m_1 \oplus sk = c] = \Pr_{sk}[m_2 \oplus sk = c]
$$

However, the modification to the definition of $K$ leads to the issue where

$$
\Pr_{sk}[m_1 \oplus sk = c] \neq \Pr_{sk}[m_2 \oplus sk = c] \text{ if } \text{pop\_count}(m_1) \not\equiv \text{pop\_count}(m_2) \mod 2
$$

---

#### Question 2: One Way Functions vs Pseudorandom Generators

#### 2.1

:::note[Description]
Let $G$ be a PRG that maps $n$ bits to $2n$ bits, prove that $G$ is a (strong) one-way function.
:::

**Solution:**

The definition of a PRG is that for any algorithm $A$, the probability that $A$ can distinguish between the output of $G:\{0,1\}^n\to \{0,1\}^{l(n)}$ (in this problem, $l(n)=2n$) on a random input and a truly random string is negligible. Formally,

$$
|\Pr_{s \leftarrow \{0,1\}^n, r \leftarrow G(s)}[\mathcal A(r)=1]-\Pr_{r \xleftarrow{\mathbb{R}}\{0,1\}^{l(n)}}[\mathcal A(r)=1]| \leq \mathtt{negl}(n)
$$

If $G$ is not a one-way function, there exists an efficient algorithm $\mathcal A$ that can invert $G$.

**Idea:**

Assume $G \in \text{PRG}[\{0,1\}^n \to \{0,1\}^{2n}]$ is not a one-way function, then there exists $\mathcal A_0$ such that

$$
\Pr_{x}[f(\mathcal A_0(G(x))=G(x)] \geqslant \frac{1}{\text{poly}(n)}
$$

($G$ here is essentially the function $f$ in the definition).

In this scenario, consider

$$
\mathcal A':\{0,1\}^{2n}\to \{0,1\} \mid \mathcal A'(r)=[G(\mathcal A_0(r))=r]
$$

Then,

$$
\Pr_{s \leftarrow \{0,1\}^n, r \leftarrow G(s)}[\mathcal A'(r)=1] = \Pr_{s\leftarrow \{0,1\}^n}[G(\mathcal A_0(G(s)))=G(s)] \geqslant \frac{1}{\text{poly}(n)}
$$

and

$$
\Pr_{r \xleftarrow{\mathbb{R}}\{0,1\}^{2n}}[\mathcal A'(r)=1] \leq \Pr_{r\xleftarrow{\mathbb R}\{0,1\}^{2n}}[\exists s\in \{0,1\}^n,G(s)=r] = \frac{2^n}{2^{2n}} = \frac{1}{2^n}
$$

Thus,

$$
\left|\Pr_{s \leftarrow \{0,1\}^n, r \leftarrow G(s)}[\mathcal A'(r)=1]-\Pr_{r \xleftarrow{\mathbb{R}}\{0,1\}^{2n}}[\mathcal A'(r)=1]\right| \geq \left|\frac{1}{\text{poly}(n)}-\frac{1}{2^n}\right| \geq \frac{1}{\text{poly'}(n)}
$$

Since $\frac{1}{\text{poly'}(n)} \neq \mathtt{negl}(n)$, this contradicts the initial assumption. Therefore, $G$ is a one-way function.

#### 2.2

:::note[Description]
Given that $F$ is a one-way function, construct a function $G$ such that:

- $G$ is a one-way function.
- $G$ is not a pseudorandom generator (PRG).
  :::

**Solution:**

Directly provide the construction:
Let

$$
F:\{0,1\}^n\to \{0,1\}^{l(n)}
$$

Construct

$$
G:\{0,1\}^n\to \{0,1\}^{l(n)+1} \mid G(r)=\text{concat}(F(r),\{\mathtt{1}\})
$$

Here, $\text{concat}$ denotes the sequential concatenation of two binary sequences. In other words, $G$ appends a $1$ to the end of $F$'s output.

**Proof for OWF:**

Since $F$ satisfies

$$
\forall \mathcal A:\{0,1\}^{l(n)}\to \{0,1\}^n, \Pr_{x \xleftarrow{\mathbb R}{} \{0,1\}^{n} }[F(\mathcal A(F(x)))=F(x)] \leqslant \mathtt{negl}(x)
$$

If $G$ is not OWF, then there exists $\mathcal A_0:\{0,1\}^{l(n)+1}\to \{0,1\}^n,\text{poly}(\cdot)$ such that

$$
\Pr_{x \xleftarrow{\mathbb R}{} \{0,1\}^n}[G(\mathcal A_0(G(x)))=G(x)] \geqslant \frac{1}{\text{poly}(n)}
$$

Then we construct $\mathcal A'_0:{0,1}^{l(n)}\to {0,1}^{n} \mid \mathcal {A}'_0(r)=\mathcal A_0(\text{concat}(r,{\mathtt{1}}))$

$\mathcal A_0'$ satisfies

$$
\Pr_{x \xleftarrow{\mathbb R}{} \{0,1\}^n}[F(\mathcal A_0'(F(x)))=F(x)] \geqslant \frac{1}{\text{poly}(n)}
$$

This contradicts the fact that $F$ is an OWF.

**Proof for not PRG:**

Construct

$$
\mathcal A'':\{0,1\}^{l(n)+1}\to \{0,1\} \mid \begin{cases}1 & r_{l(n)+1}=1\\ 0 & r_{l(n)+1}=0\end{cases}
$$

Then

$$
|\Pr_{s \leftarrow \{0,1\}^n, r \leftarrow G(s)}[\mathcal A(r)=1]-\Pr_{r \xleftarrow{\mathbb{R}}\{0,1\}^{l(n)+1}}[\mathcal A(r)=1]| = 1-\frac{1}{2} = \frac{1}{2}
$$

Clearly, this contradicts the requirement for the PRG definition of being negligible.

In summary, the constructed $G$ is a One-Way Function but not a PRG.br


## ç¬¬äºŒæ¬¡ä½œä¸šï¼šCCA-PRP


<iframe
  src="/pdfjs-4.6.82-dist/web/viewer.html?file=/file/cryptohw2.pdf"
  width="100%"
  height="800px"></iframe>
></iframe>
